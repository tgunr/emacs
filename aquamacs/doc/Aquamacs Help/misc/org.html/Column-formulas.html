<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<!-- This manual is for Org version 8.2.9.

Copyright (C) 2004-2016 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, with the Front-Cover Texts being "A GNU Manual,"
and with the Back-Cover Texts as in (a) below.  A copy of the license
is included in the section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual." -->
<!-- Created by GNU Texinfo 5.2, http://www.gnu.org/software/texinfo/ -->

<head>
  <meta name="generator" content=
  "HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 16.1), see www.w3.org" />

  <title>The Org Manual: Column formulas</title>
  <meta name="description" content=
  "The Org Manual: Column formulas" />
  <meta name="keywords" content=
  "The Org Manual: Column formulas" />
  <meta name="resource-type" content="document" />
  <meta name="distribution" content="global" />
  <meta name="Generator" content="makeinfo" />
  <meta http-equiv="Content-Type" content=
  "text/html; charset=us-ascii" />
  <link href="index.html#Top" rel="start" title="Top" />
  <link href="Main-Index.html#Main-Index" rel="index" title=
  "Main Index" />
  <link href="index.html#SEC_Contents" rel="contents" title=
  "Table of Contents" />
  <link href="The-spreadsheet.html#The-spreadsheet" rel="up" title=
  "The spreadsheet" />
  <link href="Lookup-functions.html#Lookup-functions" rel="next"
  title="Lookup functions" />
  <link href=
  "Field-and-range-formulas.html#Field-and-range-formulas" rel=
  "prev" title="Field and range formulas" />
  <style type="text/css">
/*<![CDATA[*/
  <!--
  a.summary-letter {text-decoration: none}
  blockquote.smallquotation {font-size: smaller}
  div.display {margin-left: 3.2em}
  div.example {margin-left: 3.2em}
  div.indentedblock {margin-left: 3.2em}
  div.lisp {margin-left: 3.2em}
  div.smalldisplay {margin-left: 3.2em}
  div.smallexample {margin-left: 3.2em}
  div.smallindentedblock {margin-left: 3.2em; font-size: smaller}
  div.smalllisp {margin-left: 3.2em}
  kbd {font-style:oblique}
  pre.display {font-family: inherit}
  pre.format {font-family: inherit}
  pre.menu-comment {font-family: serif}
  pre.menu-preformatted {font-family: serif}
  pre.smalldisplay {font-family: inherit; font-size: smaller}
  pre.smallexample {font-size: smaller}
  pre.smallformat {font-family: inherit; font-size: smaller}
  pre.smalllisp {font-size: smaller}
  span.nocodebreak {white-space:nowrap}
  span.nolinebreak {white-space:nowrap}
  span.roman {font-family:serif; font-weight:normal}
  span.sansserif {font-family:sans-serif; font-weight:normal}
  ul.no-bullet {list-style: none}
  -->
  /*]]>*/
  </style>
  <style type="text/css">
/*<![CDATA[*/
  body {
  background-color: #FFFFFF;
  color: #000000;
  }
  :link { color: #0000FF }
  :visited { color: #800080 }
  :active { color: #FF0000 }
  /*]]>*/
  </style>
</head>

<body lang="en" xml:lang="en">
  <a name="Column-formulas" id="Column-formulas"></a>

  <div class="header">
    <p>Next: <a href="Lookup-functions.html#Lookup-functions"
    accesskey="n" rel="next">Lookup functions</a>, Previous:
    <a href=
    "Field-and-range-formulas.html#Field-and-range-formulas"
    accesskey="p" rel="prev">Field and range formulas</a>, Up:
    <a href="The-spreadsheet.html#The-spreadsheet" accesskey="u"
    rel="up">The spreadsheet</a> &nbsp; [<a href=
    "index.html#SEC_Contents" title="Table of contents" rel=
    "contents">Contents</a>][<a href="Main-Index.html#Main-Index"
    title="Index" rel="index">Index</a>]</p>
  </div>
  <hr />
  <a name="Column-formulas-1" id="Column-formulas-1"></a>

  <h4 class="subsection">3.5.6 Column formulas</h4><a name=
  "index-column-formula" id="index-column-formula"></a> <a name=
  "index-formula_002c-for-table-column" id=
  "index-formula_002c-for-table-column"></a>

  <p>When you assign a formula to a simple column reference like
  <code>$3=</code>, the same formula will be used in all fields of
  that column, with the following very convenient exceptions: (i)
  If the table contains horizontal separator hlines with rows above
  and below, everything before the first such hline is considered
  part of the table <em>header</em> and will not be modified by
  column formulas. Therefore a header is mandatory when you use
  column formulas and want to add hlines to group rows, like for
  example to separate a total row at the bottom from the summand
  rows above. (ii) Fields that already get a value from a
  field/range formula will be left alone by column formulas. These
  conditions make column formulas very easy to use.</p>

  <p>To assign a formula to a column, type it directly into any
  field in the column, preceded by an equal sign, like
  &lsquo;<samp>=$1+$2</samp>&rsquo;. When you press <tt class=
  "key">TAB</tt> or <tt class="key">RET</tt> or <kbd>C-c C-c</kbd>
  with the cursor still in the field, the formula will be stored as
  the formula for the current column, evaluated and the current
  field replaced with the result. If the field contains only
  &lsquo;<samp>=</samp>&rsquo;, the previously stored formula for
  this column is used. For each column, Org will only remember the
  most recently used formula. In the
  &lsquo;<samp>#+TBLFM:</samp>&rsquo; line, column formulas will
  look like &lsquo;<samp>$4=$1+$2</samp>&rsquo;. The left-hand side
  of a column formula can not be the name of column, it must be the
  numeric column reference or <code>$&gt;</code>.</p>

  <p>Instead of typing an equation into the field, you may also use
  the following command:</p>

  <dl compact="compact">
    <dd><a name="index-C_002dc-_003d" id="index-C_002dc-_003d"></a>
    <a name="index-org_002dtable_002deval_002dformula-1" id=
    "index-org_002dtable_002deval_002dformula-1"></a></dd>

    <dt><kbd><kbd>C-c =</kbd>
    &nbsp;&nbsp;&nbsp;&nbsp;(<code>org-table-eval-formula</code>)</kbd></dt>

    <dd>
      <p>Install a new formula for the current column and replace
      current field with the result of the formula. The command
      prompts for a formula, with default taken from the
      &lsquo;<samp>#+TBLFM</samp>&rsquo; line, applies it to the
      current field and stores it. With a numeric prefix
      argument(e.g., <kbd>C-5 C-c =</kbd>) the command will apply
      it to that many consecutive fields in the current column.</p>
    </dd>
  </dl>
  <hr />

  <div class="header">
    <p>Next: <a href="Lookup-functions.html#Lookup-functions"
    accesskey="n" rel="next">Lookup functions</a>, Previous:
    <a href=
    "Field-and-range-formulas.html#Field-and-range-formulas"
    accesskey="p" rel="prev">Field and range formulas</a>, Up:
    <a href="The-spreadsheet.html#The-spreadsheet" accesskey="u"
    rel="up">The spreadsheet</a> &nbsp; [<a href=
    "index.html#SEC_Contents" title="Table of contents" rel=
    "contents">Contents</a>][<a href="Main-Index.html#Main-Index"
    title="Index" rel="index">Index</a>]</p>
  </div>
</body>
</html>
