<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<!-- This file documents Calc, the GNU Emacs calculator, included with
GNU Emacs 25.1.

Copyright (C) 1990-1991, 2001-2016 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being just "GNU GENERAL PUBLIC LICENSE", with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the section
entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual." -->
<!-- Created by GNU Texinfo 5.2, http://www.gnu.org/software/texinfo/ -->

<head>
  <meta name="generator" content=
  "HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 16.1), see www.w3.org" />

  <title>GNU Emacs Calc Manual: Packing and Unpacking</title>
  <meta name="description" content=
  "GNU Emacs Calc Manual: Packing and Unpacking" />
  <meta name="keywords" content=
  "GNU Emacs Calc Manual: Packing and Unpacking" />
  <meta name="resource-type" content="document" />
  <meta name="distribution" content="global" />
  <meta name="Generator" content="makeinfo" />
  <meta http-equiv="Content-Type" content=
  "text/html; charset=us-ascii" />
  <link href="index.html#Top" rel="start" title="Top" />
  <link href="Key-Index.html#Key-Index" rel="index" title=
  "Key Index" />
  <link href="index.html#SEC_Contents" rel="contents" title=
  "Table of Contents" />
  <link href="Matrix-Functions.html#Matrix-Functions" rel="up"
  title="Matrix Functions" />
  <link href="Building-Vectors.html#Building-Vectors" rel="next"
  title="Building Vectors" />
  <link href="Matrix-Functions.html#Matrix-Functions" rel="prev"
  title="Matrix Functions" />
  <style type="text/css">
/*<![CDATA[*/
  <!--
  a.summary-letter {text-decoration: none}
  blockquote.smallquotation {font-size: smaller}
  div.display {margin-left: 3.2em}
  div.example {margin-left: 3.2em}
  div.indentedblock {margin-left: 3.2em}
  div.lisp {margin-left: 3.2em}
  div.smalldisplay {margin-left: 3.2em}
  div.smallexample {margin-left: 3.2em}
  div.smallindentedblock {margin-left: 3.2em; font-size: smaller}
  div.smalllisp {margin-left: 3.2em}
  kbd {font-style:oblique}
  pre.display {font-family: inherit}
  pre.format {font-family: inherit}
  pre.menu-comment {font-family: serif}
  pre.menu-preformatted {font-family: serif}
  pre.smalldisplay {font-family: inherit; font-size: smaller}
  pre.smallexample {font-size: smaller}
  pre.smallformat {font-family: inherit; font-size: smaller}
  pre.smalllisp {font-size: smaller}
  span.nocodebreak {white-space:nowrap}
  span.nolinebreak {white-space:nowrap}
  span.roman {font-family:serif; font-weight:normal}
  span.sansserif {font-family:sans-serif; font-weight:normal}
  ul.no-bullet {list-style: none}
  -->
  /*]]>*/
  </style>
  <style type="text/css">
/*<![CDATA[*/
  body {
  background-color: #FFFFFF;
  color: #000000;
  }
  :link { color: #0000FF }
  :visited { color: #800080 }
  :active { color: #FF0000 }
  /*]]>*/
  </style>
</head>

<body lang="en" xml:lang="en">
  <a name="Packing-and-Unpacking" id="Packing-and-Unpacking"></a>

  <div class="header">
    <p>Next: <a href="Building-Vectors.html#Building-Vectors"
    accesskey="n" rel="next">Building Vectors</a>, Previous:
    <a href="Matrix-Functions.html#Matrix-Functions" accesskey="p"
    rel="prev">Matrix Functions</a>, Up: <a href=
    "Matrix-Functions.html#Matrix-Functions" accesskey="u" rel=
    "up">Matrix Functions</a> &nbsp; [<a href=
    "index.html#SEC_Contents" title="Table of contents" rel=
    "contents">Contents</a>][<a href="Key-Index.html#Key-Index"
    title="Index" rel="index">Index</a>]</p>
  </div>
  <hr />
  <a name="Packing-and-Unpacking-1" id=
  "Packing-and-Unpacking-1"></a>

  <h3 class="section">9.1 Packing and Unpacking</h3>

  <p>Calc&rsquo;s &ldquo;pack&rdquo; and &ldquo;unpack&rdquo;
  commands collect stack entries to build composite objects such as
  vectors and complex numbers. They are described in this chapter
  because they are most often used to build vectors.</p><a name=
  "index-v-p" id="index-v-p"></a> <a name="index-V-p" id=
  "index-V-p"></a> <a name="index-calc_002dpack-1" id=
  "index-calc_002dpack-1"></a>

  <p>The <kbd>v p</kbd> (<code>calc-pack</code>)
  [<code>pack</code>] command collects several elements from the
  stack into a matrix, complex number, HMS form, error form, etc.
  It uses a numeric prefix argument to specify the kind of object
  to be built; this argument is referred to as the &ldquo;packing
  mode.&rdquo; If the packing mode is a nonnegative integer, a
  vector of that length is created. For example, <kbd>C-u 5 v
  p</kbd> will pop the top five stack elements and push back a
  single vector of those five elements. (<kbd>C-u 0 v p</kbd>
  simply creates an empty vector.)</p>

  <p>The same effect can be had by pressing <kbd>[</kbd> to push an
  incomplete vector on the stack, using <tt class="key">TAB</tt>
  (<code>calc-roll-down</code>) to sneak the incomplete object up
  past a certain number of elements, and then pressing <kbd>]</kbd>
  to complete the vector.</p>

  <p>Negative packing modes create other kinds of composite
  objects:</p>

  <dl compact="compact">
    <dt><cite>-1</cite></dt>

    <dd>
      <p>Two values are collected to build a complex number. For
      example, <kbd>5 <span class="key">RET</span> 7 C-u -1 v
      p</kbd> creates the complex number &lsquo;<samp>(5,
      7)</samp>&rsquo;. The result is always a rectangular complex
      number. The two input values must both be real numbers, i.e.,
      integers, fractions, or floats. If they are not, Calc will
      instead build a formula like &lsquo;<samp>a + (0, 1)
      b</samp>&rsquo;. (The other packing modes also create a
      symbolic answer if the components are not suitable.)</p>
    </dd>

    <dt><cite>-2</cite></dt>

    <dd>
      <p>Two values are collected to build a polar complex number.
      The first is the magnitude; the second is the phase expressed
      in either degrees or radians according to the current angular
      mode.</p>
    </dd>

    <dt><cite>-3</cite></dt>

    <dd>
      <p>Three values are collected into an HMS form. The first two
      values (hours and minutes) must be integers or integer-valued
      floats. The third value may be any real number.</p>
    </dd>

    <dt><cite>-4</cite></dt>

    <dd>
      <p>Two values are collected into an error form. The inputs
      may be real numbers or formulas.</p>
    </dd>

    <dt><cite>-5</cite></dt>

    <dd>
      <p>Two values are collected into a modulo form. The inputs
      must be real numbers.</p>
    </dd>

    <dt><cite>-6</cite></dt>

    <dd>
      <p>Two values are collected into the interval &lsquo;<samp>[a
      .. b]</samp>&rsquo;. The inputs may be real numbers, HMS or
      date forms, or formulas.</p>
    </dd>

    <dt><cite>-7</cite></dt>

    <dd>
      <p>Two values are collected into the interval &lsquo;<samp>[a
      .. b)</samp>&rsquo;.</p>
    </dd>

    <dt><cite>-8</cite></dt>

    <dd>
      <p>Two values are collected into the interval &lsquo;<samp>(a
      .. b]</samp>&rsquo;.</p>
    </dd>

    <dt><cite>-9</cite></dt>

    <dd>
      <p>Two values are collected into the interval &lsquo;<samp>(a
      .. b)</samp>&rsquo;.</p>
    </dd>

    <dt><cite>-10</cite></dt>

    <dd>
      <p>Two integer values are collected into a fraction.</p>
    </dd>

    <dt><cite>-11</cite></dt>

    <dd>
      <p>Two values are collected into a floating-point number. The
      first is the mantissa; the second, which must be an integer,
      is the exponent. The result is the mantissa times ten to the
      power of the exponent.</p>
    </dd>

    <dt><cite>-12</cite></dt>

    <dd>
      <p>This is treated the same as <i>-11</i> by the <kbd>v
      p</kbd> command. When unpacking, <i>-12</i> specifies that a
      floating-point mantissa is desired.</p>
    </dd>

    <dt><cite>-13</cite></dt>

    <dd>
      <p>A real number is converted into a date form.</p>
    </dd>

    <dt><cite>-14</cite></dt>

    <dd>
      <p>Three numbers (year, month, day) are packed into a pure
      date form.</p>
    </dd>

    <dt><cite>-15</cite></dt>

    <dd>
      <p>Six numbers are packed into a date/time form.</p>
    </dd>
  </dl>

  <p>With any of the two-input negative packing modes, either or
  both of the inputs may be vectors. If both are vectors of the
  same length, the result is another vector made by packing
  corresponding elements of the input vectors. If one input is a
  vector and the other is a plain number, the number is packed
  along with each vector element to produce a new vector. For
  example, <kbd>C-u -4 v p</kbd> could be used to convert a vector
  of numbers and a vector of errors into a single vector of error
  forms; <kbd>C-u -5 v p</kbd> could convert a vector of numbers
  and a single number <var>M</var> into a vector of numbers modulo
  <var>M</var>.</p>

  <p>If you don&rsquo;t give a prefix argument to <kbd>v p</kbd>,
  it takes the packing mode from the top of the stack. The elements
  to be packed then begin at stack level 2. Thus <kbd>1
  <span class="key">RET</span> 2 <span class="key">RET</span> 4 n v
  p</kbd> is another way to enter the error form &lsquo;<samp>1 +/-
  2</samp>&rsquo;.</p>

  <p>If the packing mode taken from the stack is a vector, the
  result is a matrix with the dimensions specified by the elements
  of the vector, which must each be integers. For example, if the
  packing mode is &lsquo;<samp>[2, 3]</samp>&rsquo;, then six
  numbers will be taken from the stack and returned in the form
  &lsquo;<samp>[[a,&nbsp;b,&nbsp;c]<!-- /@w -->, [d, e,
  f]]</samp>&rsquo;.</p>

  <p>If any elements of the vector are negative, other kinds of
  packing are done at that level as described above. For example,
  &lsquo;<samp>[2, 3, -4]</samp>&rsquo; takes 12 objects and
  creates a 2x3 matrix of error forms: &lsquo;<samp>[[a +/- b, c
  +/- d ... ]]</samp>&rsquo;. Also, &lsquo;<samp>[-4,
  -10]</samp>&rsquo; will convert four integers into an error form
  consisting of two fractions: &lsquo;<samp>a:b +/-
  c:d</samp>&rsquo;.</p><a name="index-pack" id="index-pack"></a>

  <p>There is an equivalent algebraic function,
  &lsquo;<samp>pack(<var>mode</var>,
  <var>items</var>)</samp>&rsquo; where <var>mode</var> is a
  packing mode (an integer or a vector of integers) and
  <var>items</var> is a vector of objects to be packed (re-packed,
  really) according to that mode. For example,
  &lsquo;<samp>pack([3, -4], [a,b,c,d,e,f])</samp>&rsquo; yields
  &lsquo;<samp>[a +/- b, c&nbsp;<span class=
  "nolinebreak">+/-</span>&nbsp;d<!-- /@w -->, e +/-
  f]</samp>&rsquo;. The function is left in symbolic form if the
  packing mode is invalid, or if the number of data items does not
  match the number of items required by the mode.</p><a name=
  "index-v-u" id="index-v-u"></a> <a name="index-V-u" id=
  "index-V-u"></a> <a name="index-calc_002dunpack-1" id=
  "index-calc_002dunpack-1"></a>

  <p>The <kbd>v u</kbd> (<code>calc-unpack</code>) command takes
  the vector, complex number, HMS form, or other composite object
  on the top of the stack and &ldquo;unpacks&rdquo; it, pushing
  each of its elements onto the stack as separate objects. Thus, it
  is the &ldquo;inverse&rdquo; of <kbd>v p</kbd>. If the value at
  the top of the stack is a formula, <kbd>v u</kbd> unpacks it by
  pushing each of the arguments of the top-level operator onto the
  stack.</p>

  <p>You can optionally give a numeric prefix argument to <kbd>v
  u</kbd> to specify an explicit (un)packing mode. If the packing
  mode is negative and the input is actually a vector or matrix,
  the result will be two or more similar vectors or matrices of the
  elements. For example, given the vector
  &lsquo;<samp>[a&nbsp;<span class="nolinebreak">+/-</span>&nbsp;b
  <!-- /@w -->, c^2, d +/- 7]</samp>&rsquo;, the result of <kbd>C-u
  -4 v u</kbd> will be the two vectors &lsquo;<samp>[a, c^2,
  d]</samp>&rsquo; and
  &lsquo;<samp>[b,&nbsp;0,&nbsp;7]</samp>&rsquo;<!-- /@w -->.</p>

  <p>Note that the prefix argument can have an effect even when the
  input is not a vector. For example, if the input is the number
  <i>-5</i>, then <kbd>c-u -1 v u</kbd> yields <i>-5</i> and 0 (the
  components of <i>-5</i> when viewed as a rectangular complex
  number); <kbd>C-u -2 v u</kbd> yields 5 and 180 (assuming Degrees
  mode); and <kbd>C-u -10 v u</kbd> yields <i>-5</i> and 1 (the
  numerator and denominator of <i>-5</i>, viewed as a rational
  number). Plain <kbd>v u</kbd> with this input would complain that
  the input is not a composite object.</p>

  <p>Unpacking mode <i>-11</i> converts a float into an integer
  mantissa and an integer exponent, where the mantissa is not
  divisible by 10 (except that 0.0 is represented by a mantissa and
  exponent of 0). Unpacking mode <i>-12</i> converts a float into a
  floating-point mantissa and integer exponent, where the mantissa
  (for non-zero numbers) is guaranteed to lie in the range [1 ..
  10). In both cases, the mantissa is shifted left or right (and
  the exponent adjusted to compensate) in order to satisfy these
  constraints.</p>

  <p>Positive unpacking modes are treated differently than for
  <kbd>v p</kbd>. A mode of 1 is much like plain <kbd>v u</kbd>
  with no prefix argument, except that in addition to the
  components of the input object, a suitable packing mode to
  re-pack the object is also pushed. Thus, <kbd>C-u 1 v u</kbd>
  followed by <kbd>v p</kbd> will re-build the original object.</p>

  <p>A mode of 2 unpacks two levels of the object; the resulting
  re-packing mode will be a vector of length 2. This might be used
  to unpack a matrix, say, or a vector of error forms. Higher
  unpacking modes unpack the input even more deeply.</p><a name=
  "index-unpack" id="index-unpack"></a>

  <p>There are two algebraic functions analogous to <kbd>v u</kbd>.
  The &lsquo;<samp>unpack(<var>mode</var>,
  <var>item</var>)</samp>&rsquo; function unpacks the
  <var>item</var> using the given <var>mode</var>, returning the
  result as a vector of components. Here the <var>mode</var> must
  be an integer, not a vector. For example, &lsquo;<samp>unpack(-4,
  a +/- b)</samp>&rsquo; returns &lsquo;<samp>[a, b]</samp>&rsquo;,
  as does &lsquo;<samp>unpack(1, a +/-
  b)</samp>&rsquo;.</p><a name="index-unpackt" id=
  "index-unpackt"></a>

  <p>The <code>unpackt</code> function is like <code>unpack</code>
  but instead of returning a simple vector of items, it returns a
  vector of two things: The mode, and the vector of items. For
  example, &lsquo;<samp>unpackt(1, 2:3 +/- 1:4)</samp>&rsquo;
  returns &lsquo;<samp>[-4, [2:3, 1:4]]</samp>&rsquo;, and
  &lsquo;<samp>unpackt(2, 2:3 +/- 1:4)</samp>&rsquo; returns
  &lsquo;<samp>[[-4, -10], [2, 3, 1, 4]]</samp>&rsquo;. The
  identity for re-building the original object is
  &lsquo;<samp>apply(pack, unpackt(<var>n</var>, <var>x</var>)) =
  <var>x</var></samp>&rsquo;. (The <code>apply</code> function
  builds a function call given the function name and a vector of
  arguments.)</p><a name=
  "index-Numerator-of-a-fraction_002c-extracting" id=
  "index-Numerator-of-a-fraction_002c-extracting"></a>

  <p>Subscript notation is a useful way to extract a particular
  part of an object. For example, to get the numerator of a
  rational number, you can use &lsquo;<samp>unpack(-10,
  <var>x</var>)_1</samp>&rsquo;.</p>
  <hr />

  <div class="header">
    <p>Next: <a href="Building-Vectors.html#Building-Vectors"
    accesskey="n" rel="next">Building Vectors</a>, Previous:
    <a href="Matrix-Functions.html#Matrix-Functions" accesskey="p"
    rel="prev">Matrix Functions</a>, Up: <a href=
    "Matrix-Functions.html#Matrix-Functions" accesskey="u" rel=
    "up">Matrix Functions</a> &nbsp; [<a href=
    "index.html#SEC_Contents" title="Table of contents" rel=
    "contents">Contents</a>][<a href="Key-Index.html#Key-Index"
    title="Index" rel="index">Index</a>]</p>
  </div>
</body>
</html>
