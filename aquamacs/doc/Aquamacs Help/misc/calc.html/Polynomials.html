<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<!-- This file documents Calc, the GNU Emacs calculator, included with
GNU Emacs 25.1.

Copyright (C) 1990-1991, 2001-2016 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being just "GNU GENERAL PUBLIC LICENSE", with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the section
entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual." -->
<!-- Created by GNU Texinfo 5.2, http://www.gnu.org/software/texinfo/ -->

<head>
  <meta name="generator" content=
  "HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 16.1), see www.w3.org" />

  <title>GNU Emacs Calc Manual: Polynomials</title>
  <meta name="description" content=
  "GNU Emacs Calc Manual: Polynomials" />
  <meta name="keywords" content=
  "GNU Emacs Calc Manual: Polynomials" />
  <meta name="resource-type" content="document" />
  <meta name="distribution" content="global" />
  <meta name="Generator" content="makeinfo" />
  <meta http-equiv="Content-Type" content=
  "text/html; charset=us-ascii" />
  <link href="index.html#Top" rel="start" title="Top" />
  <link href="Key-Index.html#Key-Index" rel="index" title=
  "Key Index" />
  <link href="index.html#SEC_Contents" rel="contents" title=
  "Table of Contents" />
  <link href="Algebra.html#Algebra" rel="up" title="Algebra" />
  <link href="Calculus.html#Calculus" rel="next" title=
  "Calculus" />
  <link href="Simplification-of-Units.html#Simplification-of-Units"
  rel="prev" title="Simplification of Units" />
  <style type="text/css">
/*<![CDATA[*/
  <!--
  a.summary-letter {text-decoration: none}
  blockquote.smallquotation {font-size: smaller}
  div.display {margin-left: 3.2em}
  div.example {margin-left: 3.2em}
  div.indentedblock {margin-left: 3.2em}
  div.lisp {margin-left: 3.2em}
  div.smalldisplay {margin-left: 3.2em}
  div.smallexample {margin-left: 3.2em}
  div.smallindentedblock {margin-left: 3.2em; font-size: smaller}
  div.smalllisp {margin-left: 3.2em}
  kbd {font-style:oblique}
  pre.display {font-family: inherit}
  pre.format {font-family: inherit}
  pre.menu-comment {font-family: serif}
  pre.menu-preformatted {font-family: serif}
  pre.smalldisplay {font-family: inherit; font-size: smaller}
  pre.smallexample {font-size: smaller}
  pre.smallformat {font-family: inherit; font-size: smaller}
  pre.smalllisp {font-size: smaller}
  span.nocodebreak {white-space:nowrap}
  span.nolinebreak {white-space:nowrap}
  span.roman {font-family:serif; font-weight:normal}
  span.sansserif {font-family:sans-serif; font-weight:normal}
  ul.no-bullet {list-style: none}
  -->
  /*]]>*/
  </style>
  <style type="text/css">
/*<![CDATA[*/
  body {
  background-color: #FFFFFF;
  color: #000000;
  }
  :link { color: #0000FF }
  :visited { color: #800080 }
  :active { color: #FF0000 }
  /*]]>*/
  </style>
</head>

<body lang="en" xml:lang="en">
  <a name="Polynomials" id="Polynomials"></a>

  <div class="header">
    <p>Next: <a href="Calculus.html#Calculus" accesskey="n" rel=
    "next">Calculus</a>, Previous: <a href=
    "Simplifying-Formulas.html#Simplifying-Formulas" accesskey="p"
    rel="prev">Simplifying Formulas</a>, Up: <a href=
    "Algebra.html#Algebra" accesskey="u" rel="up">Algebra</a>
    &nbsp; [<a href="index.html#SEC_Contents" title=
    "Table of contents" rel="contents">Contents</a>][<a href=
    "Key-Index.html#Key-Index" title="Index" rel=
    "index">Index</a>]</p>
  </div>
  <hr />
  <a name="Polynomials-1" id="Polynomials-1"></a>

  <h3 class="section">10.4 Polynomials</h3>

  <p>A <em>polynomial</em> is a sum of terms which are coefficients
  times various powers of a &ldquo;base&rdquo; variable. For
  example, &lsquo;<samp>2 x^2 + 3 x - 4</samp>&rsquo; is a
  polynomial in &lsquo;<samp>x</samp>&rsquo;. Some formulas can be
  considered polynomials in several different variables:
  &lsquo;<samp>1 + 2 x + 3 y + 4 x y^2</samp>&rsquo; is a
  polynomial in both &lsquo;<samp>x</samp>&rsquo; and
  &lsquo;<samp>y</samp>&rsquo;. Polynomial coefficients are often
  numbers, but they may in general be any formulas not involving
  the base variable.</p><a name="index-a-f" id="index-a-f"></a>
  <a name="index-calc_002dfactor" id="index-calc_002dfactor"></a>
  <a name="index-factor" id="index-factor"></a>

  <p>The <kbd>a f</kbd> (<code>calc-factor</code>)
  [<code>factor</code>] command factors a polynomial into a product
  of terms. For example, the polynomial &lsquo;<samp>x^3 + 2 x^2 +
  x</samp>&rsquo; is factored into
  &lsquo;<samp>x*(x+1)^2</samp>&rsquo;. As another example,
  &lsquo;<samp>a c + b d + b c + a d</samp>&rsquo; is factored into
  the product &lsquo;<samp>(a + b) (c + d)</samp>&rsquo;.</p>

  <p>Calc currently has three algorithms for factoring. Formulas
  which are linear in several variables, such as the second example
  above, are merged according to the distributive law. Formulas
  which are polynomials in a single variable, with constant integer
  or fractional coefficients, are factored into irreducible linear
  and/or quadratic terms. The first example above factors into
  three linear terms (&lsquo;<samp>x</samp>&rsquo;,
  &lsquo;<samp>x+1</samp>&rsquo;, and
  &lsquo;<samp>x+1</samp>&rsquo; again). Finally, formulas which do
  not fit the above criteria are handled by the algebraic rewrite
  mechanism.</p>

  <p>Calc&rsquo;s polynomial factorization algorithm works by using
  the general root-finding command (<kbd>a&nbsp;P</kbd>
  <!-- /@w -->) to solve for the roots of the polynomial. It then
  looks for roots which are rational numbers or complex-conjugate
  pairs, and converts these into linear and quadratic terms,
  respectively. Because it uses floating-point arithmetic, it may
  be unable to find terms that involve large integers (whose number
  of digits approaches the current precision). Also, irreducible
  factors of degree higher than quadratic are not found, and
  polynomials in more than one variable are not treated. (A more
  robust factorization algorithm may be included in a future
  version of Calc.)</p><a name="index-FactorRules" id=
  "index-FactorRules"></a> <a name="index-thecoefs" id=
  "index-thecoefs"></a> <a name="index-thefactors" id=
  "index-thefactors"></a>

  <p>The rewrite-based factorization method uses rules stored in
  the variable <code>FactorRules</code>. See <a href=
  "Rewrite-Rules.html#Rewrite-Rules">Rewrite Rules</a>, for a
  discussion of the operation of rewrite rules. The default
  <code>FactorRules</code> are able to factor quadratic forms
  symbolically into two linear terms, &lsquo;<samp>(a x + b) (c x +
  d)</samp>&rsquo;. You can edit these rules to include other cases
  if you wish. To use the rules, Calc builds the formula
  &lsquo;<samp>thecoefs(x, [a, b, c, ...])</samp>&rsquo; where
  <code>x</code> is the polynomial base variable and
  <code>a</code>, <code>b</code>, etc., are polynomial coefficients
  (which may be numbers or formulas). The constant term is written
  first, i.e., in the <code>a</code> position. When the rules
  complete, they should have changed the formula into the form
  &lsquo;<samp>thefactors(x, [f1, f2, f3, ...])</samp>&rsquo; where
  each <code>fi</code> should be a factored term, e.g.,
  &lsquo;<samp>x - ai</samp>&rsquo;. Calc then multiplies these
  terms together to get the complete factored form of the
  polynomial. If the rules do not change the <code>thecoefs</code>
  call to a <code>thefactors</code> call, <kbd>a f</kbd> leaves the
  polynomial alone on the assumption that it is unfactorable. (Note
  that the function names <code>thecoefs</code> and
  <code>thefactors</code> are used only as placeholders; there are
  no actual Calc functions by those names.)</p><a name=
  "index-H-a-f" id="index-H-a-f"></a> <a name="index-factors" id=
  "index-factors"></a>

  <p>The <kbd>H a f</kbd> [<code>factors</code>] command also
  factors a polynomial, but it returns a list of factors instead of
  an expression which is the product of the factors. Each factor is
  represented by a sub-vector of the factor, and the power with
  which it appears. For example, &lsquo;<samp>x^5 + x^4 - 33 x^3 +
  63 x^2</samp>&rsquo; factors to &lsquo;<samp>(x + 7) x^2 (x -
  3)^2</samp>&rsquo; in <kbd>a f</kbd>, or to &lsquo;<samp>[ [x,
  2], [x+7, 1], [x-3, 2] ]</samp>&rsquo; in <kbd>H a f</kbd>. If
  there is an overall numeric factor, it always comes first in the
  list. The functions <code>factor</code> and <code>factors</code>
  allow a second argument when written in algebraic form;
  &lsquo;<samp>factor(x,v)</samp>&rsquo; factors
  &lsquo;<samp>x</samp>&rsquo; with respect to the specific
  variable &lsquo;<samp>v</samp>&rsquo;. The default is to factor
  with respect to all the variables that appear in
  &lsquo;<samp>x</samp>&rsquo;.</p><a name="index-a-c" id=
  "index-a-c"></a> <a name="index-calc_002dcollect" id=
  "index-calc_002dcollect"></a> <a name="index-collect" id=
  "index-collect"></a>

  <p>The <kbd>a c</kbd> (<code>calc-collect</code>)
  [<code>collect</code>] command rearranges a formula as a
  polynomial in a given variable, ordered in decreasing powers of
  that variable. For example, given &lsquo;<samp>1 + 2 x + 3 y + 4
  x y^2</samp>&rsquo; on the stack, <kbd>a c x</kbd> would produce
  &lsquo;<samp>(2 + 4 y^2) x + (1 + 3 y)</samp>&rsquo;, and <kbd>a
  c y</kbd> would produce &lsquo;<samp>(4 x) y^2 + 3 y + (1 + 2
  x)</samp>&rsquo;. The polynomial will be expanded out using the
  distributive law as necessary: Collecting
  &lsquo;<samp>x</samp>&rsquo; in &lsquo;<samp>(x -
  1)^3</samp>&rsquo; produces &lsquo;<samp>x^3 - 3 x^2 + 3 x -
  1</samp>&rsquo;. Terms not involving &lsquo;<samp>x</samp>&rsquo;
  will not be expanded.</p>

  <p>The &ldquo;variable&rdquo; you specify at the prompt can
  actually be any expression: <kbd>a c ln(x+1)</kbd> will collect
  together all terms multiplied by
  &lsquo;<samp>ln(x+1)</samp>&rsquo; or integer powers thereof. If
  &lsquo;<samp>x</samp>&rsquo; also appears in the formula in a
  context other than &lsquo;<samp>ln(x+1)</samp>&rsquo;, <kbd>a
  c</kbd> will treat those occurrences as unrelated to
  &lsquo;<samp>ln(x+1)</samp>&rsquo;, i.e., as
  constants.</p><a name="index-a-x" id="index-a-x"></a> <a name=
  "index-calc_002dexpand" id="index-calc_002dexpand"></a> <a name=
  "index-expand" id="index-expand"></a>

  <p>The <kbd>a x</kbd> (<code>calc-expand</code>)
  [<code>expand</code>] command expands an expression by applying
  the distributive law everywhere. It applies to products,
  quotients, and powers involving sums. By default, it fully
  distributes all parts of the expression. With a numeric prefix
  argument, the distributive law is applied only the specified
  number of times, then the partially expanded expression is left
  on the stack.</p>

  <p>The <kbd>a x</kbd> and <kbd>j D</kbd> commands are somewhat
  redundant. Use <kbd>a x</kbd> if you want to expand all products
  of sums in your formula. Use <kbd>j D</kbd> if you want to expand
  a particular specified term of the formula. There is an exactly
  analogous correspondence between <kbd>a f</kbd> and <kbd>j
  M</kbd>. (The <kbd>j D</kbd> and <kbd>j M</kbd> commands also
  know many other kinds of expansions, such as &lsquo;<samp>exp(a +
  b) = exp(a) exp(b)</samp>&rsquo;, which <kbd>a x</kbd> and <kbd>a
  f</kbd> do not do.)</p>

  <p>Calc&rsquo;s automatic simplifications will sometimes reverse
  a partial expansion. For example, the first step in expanding
  &lsquo;<samp>(x+1)^3</samp>&rsquo; is to write &lsquo;<samp>(x+1)
  (x+1)^2</samp>&rsquo;. If <kbd>a x</kbd> stops there and tries to
  put this formula onto the stack, though, Calc will automatically
  simplify it back to &lsquo;<samp>(x+1)^3</samp>&rsquo; form. The
  solution is to turn simplification off first (see <a href=
  "Simplification-Modes.html#Simplification-Modes">Simplification
  Modes</a>), or to run <kbd>a x</kbd> without a numeric prefix
  argument so that it expands all the way in one step.</p><a name=
  "index-a-a" id="index-a-a"></a> <a name="index-calc_002dapart"
  id="index-calc_002dapart"></a> <a name="index-apart" id=
  "index-apart"></a>

  <p>The <kbd>a a</kbd> (<code>calc-apart</code>)
  [<code>apart</code>] command expands a rational function by
  partial fractions. A rational function is the quotient of two
  polynomials; <code>apart</code> pulls this apart into a sum of
  rational functions with simple denominators. In algebraic
  notation, the <code>apart</code> function allows a second
  argument that specifies which variable to use as the
  &ldquo;base&rdquo;; by default, Calc chooses the base variable
  automatically.</p><a name="index-a-n" id="index-a-n"></a>
  <a name="index-calc_002dnormalize_002drat" id=
  "index-calc_002dnormalize_002drat"></a> <a name="index-nrat" id=
  "index-nrat"></a>

  <p>The <kbd>a n</kbd> (<code>calc-normalize-rat</code>)
  [<code>nrat</code>] command attempts to arrange a formula into a
  quotient of two polynomials. For example, given &lsquo;<samp>1 +
  (a + b/c) / d</samp>&rsquo;, the result would be &lsquo;<samp>(b
  + a c + c d) / c d</samp>&rsquo;. The quotient is reduced, so
  that <kbd>a n</kbd> will simplify &lsquo;<samp>(x^2 + 2x + 1) /
  (x^2 - 1)</samp>&rsquo; by dividing out the common factor
  &lsquo;<samp>x + 1</samp>&rsquo;, yielding &lsquo;<samp>(x + 1) /
  (x - 1)</samp>&rsquo;.</p><a name="index-a-_005c" id=
  "index-a-_005c"></a> <a name="index-calc_002dpoly_002ddiv" id=
  "index-calc_002dpoly_002ddiv"></a> <a name="index-pdiv" id=
  "index-pdiv"></a>

  <p>The <kbd>a \</kbd> (<code>calc-poly-div</code>)
  [<code>pdiv</code>] command divides two polynomials
  &lsquo;<samp>u</samp>&rsquo; and &lsquo;<samp>v</samp>&rsquo;,
  yielding a new polynomial &lsquo;<samp>q</samp>&rsquo;. If
  several variables occur in the inputs, the inputs are considered
  multivariate polynomials. (Calc divides by the variable with the
  largest power in &lsquo;<samp>u</samp>&rsquo; first, or, in the
  case of equal powers, chooses the variables in alphabetical
  order.) For example, dividing &lsquo;<samp>x^2 + 3 x +
  2</samp>&rsquo; by &lsquo;<samp>x + 2</samp>&rsquo; yields
  &lsquo;<samp>x + 1</samp>&rsquo;. The remainder from the
  division, if any, is reported at the bottom of the screen and is
  also placed in the Trail along with the quotient.</p>

  <p>Using <code>pdiv</code> in algebraic notation, you can specify
  the particular variable to be used as the base:
  <code>pdiv(<var>a</var>,<var>b</var>,<var>x</var>)</code>. If
  <code>pdiv</code> is given only two arguments (as is always the
  case with the <kbd>a \</kbd> command), then it does a
  multivariate division as outlined above.</p><a name=
  "index-a-_0025" id="index-a-_0025"></a> <a name=
  "index-calc_002dpoly_002drem" id=
  "index-calc_002dpoly_002drem"></a> <a name="index-prem" id=
  "index-prem"></a>

  <p>The <kbd>a %</kbd> (<code>calc-poly-rem</code>)
  [<code>prem</code>] command divides two polynomials and keeps the
  remainder &lsquo;<samp>r</samp>&rsquo;. The quotient
  &lsquo;<samp>q</samp>&rsquo; is discarded. For any formulas
  &lsquo;<samp>a</samp>&rsquo; and &lsquo;<samp>b</samp>&rsquo;,
  the results of <kbd>a \</kbd> and <kbd>a %</kbd> satisfy
  &lsquo;<samp>a = q b + r</samp>&rsquo;. (This is analogous to
  plain <kbd>\</kbd> and <kbd>%</kbd>, which compute the integer
  quotient and remainder from dividing two numbers.)</p><a name=
  "index-a-_002f" id="index-a-_002f"></a> <a name="index-H-a-_002f"
  id="index-H-a-_002f"></a> <a name=
  "index-calc_002dpoly_002ddiv_002drem" id=
  "index-calc_002dpoly_002ddiv_002drem"></a> <a name=
  "index-pdivrem" id="index-pdivrem"></a> <a name="index-pdivide"
  id="index-pdivide"></a>

  <p>The <kbd>a /</kbd> (<code>calc-poly-div-rem</code>)
  [<code>pdivrem</code>] command divides two polynomials and
  reports both the quotient and the remainder as a vector
  &lsquo;<samp>[q, r]</samp>&rsquo;. The <kbd>H a /</kbd>
  [<code>pdivide</code>] command divides two polynomials and
  constructs the formula &lsquo;<samp>q + r/b</samp>&rsquo; on the
  stack. (Naturally if the remainder is zero, this will immediately
  simplify to &lsquo;<samp>q</samp>&rsquo;.)</p><a name="index-a-g"
  id="index-a-g"></a> <a name="index-calc_002dpoly_002dgcd" id=
  "index-calc_002dpoly_002dgcd"></a> <a name="index-pgcd" id=
  "index-pgcd"></a>

  <p>The <kbd>a g</kbd> (<code>calc-poly-gcd</code>)
  [<code>pgcd</code>] command computes the greatest common divisor
  of two polynomials. (The GCD actually is unique only to within a
  constant multiplier; Calc attempts to choose a GCD which will be
  unsurprising.) For example, the <kbd>a n</kbd> command uses
  <kbd>a g</kbd> to take the GCD of the numerator and denominator
  of a quotient, then divides each by the result using <kbd>a
  \</kbd>. (The definition of GCD ensures that this division can
  take place without leaving a remainder.)</p>

  <p>While the polynomials used in operations like <kbd>a /</kbd>
  and <kbd>a g</kbd> often have integer coefficients, this is not
  required. Calc can also deal with polynomials over the rationals
  or floating-point reals. Polynomials with modulo-form
  coefficients are also useful in many applications; if you enter
  &lsquo;<samp>(x^2 + 3 x - 1) mod 5</samp>&rsquo;, Calc
  automatically transforms this into a polynomial over the field of
  integers mod 5: &lsquo;<samp>(1 mod 5) x^2 + (3 mod 5) x + (4 mod
  5)</samp>&rsquo;.</p>

  <p>Congratulations and thanks go to Ove Ewerlid
  (<code>ewerlid@mizar.DoCS.UU.SE</code>), who contributed many of
  the polynomial routines used in the above commands.</p>

  <p>See <a href=
  "Decomposing-Polynomials.html#Decomposing-Polynomials">Decomposing
  Polynomials</a>, for several useful functions for extracting the
  individual coefficients of a polynomial.</p>
  <hr />

  <div class="header">
    <p>Next: <a href="Calculus.html#Calculus" accesskey="n" rel=
    "next">Calculus</a>, Previous: <a href=
    "Simplifying-Formulas.html#Simplifying-Formulas" accesskey="p"
    rel="prev">Simplifying Formulas</a>, Up: <a href=
    "Algebra.html#Algebra" accesskey="u" rel="up">Algebra</a>
    &nbsp; [<a href="index.html#SEC_Contents" title=
    "Table of contents" rel="contents">Contents</a>][<a href=
    "Key-Index.html#Key-Index" title="Index" rel=
    "index">Index</a>]</p>
  </div>
</body>
</html>
