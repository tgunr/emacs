<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<!-- This file documents Calc, the GNU Emacs calculator, included with
GNU Emacs 25.1.

Copyright (C) 1990-1991, 2001-2016 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with the
Invariant Sections being just "GNU GENERAL PUBLIC LICENSE", with the
Front-Cover Texts being "A GNU Manual," and with the Back-Cover
Texts as in (a) below.  A copy of the license is included in the section
entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual." -->
<!-- Created by GNU Texinfo 5.2, http://www.gnu.org/software/texinfo/ -->

<head>
  <meta name="generator" content=
  "HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 16.1), see www.w3.org" />

  <title>GNU Emacs Calc Manual: Standard Nonlinear Models</title>
  <meta name="description" content=
  "GNU Emacs Calc Manual: Standard Nonlinear Models" />
  <meta name="keywords" content=
  "GNU Emacs Calc Manual: Standard Nonlinear Models" />
  <meta name="resource-type" content="document" />
  <meta name="distribution" content="global" />
  <meta name="Generator" content="makeinfo" />
  <meta http-equiv="Content-Type" content=
  "text/html; charset=us-ascii" />
  <link href="index.html#Top" rel="start" title="Top" />
  <link href="Key-Index.html#Key-Index" rel="index" title=
  "Key Index" />
  <link href="index.html#SEC_Contents" rel="contents" title=
  "Table of Contents" />
  <link href="Curve-Fitting.html#Curve-Fitting" rel="up" title=
  "Curve Fitting" />
  <link href="Curve-Fitting-Details.html#Curve-Fitting-Details"
  rel="next" title="Curve Fitting Details" />
  <link href=
  "Error-Estimates-for-Fits.html#Error-Estimates-for-Fits" rel=
  "prev" title="Error Estimates for Fits" />
  <style type="text/css">
/*<![CDATA[*/
  <!--
  a.summary-letter {text-decoration: none}
  blockquote.smallquotation {font-size: smaller}
  div.display {margin-left: 3.2em}
  div.example {margin-left: 3.2em}
  div.indentedblock {margin-left: 3.2em}
  div.lisp {margin-left: 3.2em}
  div.smalldisplay {margin-left: 3.2em}
  div.smallexample {margin-left: 3.2em}
  div.smallindentedblock {margin-left: 3.2em; font-size: smaller}
  div.smalllisp {margin-left: 3.2em}
  kbd {font-style:oblique}
  pre.display {font-family: inherit}
  pre.format {font-family: inherit}
  pre.menu-comment {font-family: serif}
  pre.menu-preformatted {font-family: serif}
  pre.smalldisplay {font-family: inherit; font-size: smaller}
  pre.smallexample {font-size: smaller}
  pre.smallformat {font-family: inherit; font-size: smaller}
  pre.smalllisp {font-size: smaller}
  span.nocodebreak {white-space:nowrap}
  span.nolinebreak {white-space:nowrap}
  span.roman {font-family:serif; font-weight:normal}
  span.sansserif {font-family:sans-serif; font-weight:normal}
  ul.no-bullet {list-style: none}
  -->
  /*]]>*/
  </style>
  <style type="text/css">
/*<![CDATA[*/
  body {
  background-color: #FFFFFF;
  color: #000000;
  }
  :link { color: #0000FF }
  :visited { color: #800080 }
  :active { color: #FF0000 }
  /*]]>*/
  </style>
</head>

<body lang="en" xml:lang="en">
  <a name="Standard-Nonlinear-Models" id=
  "Standard-Nonlinear-Models"></a>

  <div class="header">
    <p>Next: <a href=
    "Curve-Fitting-Details.html#Curve-Fitting-Details" accesskey=
    "n" rel="next">Curve Fitting Details</a>, Previous: <a href=
    "Error-Estimates-for-Fits.html#Error-Estimates-for-Fits"
    accesskey="p" rel="prev">Error Estimates for Fits</a>, Up:
    <a href="Curve-Fitting.html#Curve-Fitting" accesskey="u" rel=
    "up">Curve Fitting</a> &nbsp; [<a href=
    "index.html#SEC_Contents" title="Table of contents" rel=
    "contents">Contents</a>][<a href="Key-Index.html#Key-Index"
    title="Index" rel="index">Index</a>]</p>
  </div>
  <hr />
  <a name="Standard-Nonlinear-Models-1" id=
  "Standard-Nonlinear-Models-1"></a>

  <h4 class="subsection">10.8.4 Standard Nonlinear Models</h4>

  <p>The <kbd>a F</kbd> command also accepts other kinds of models
  besides lines and polynomials. Some common models have quick
  single-key abbreviations; others must be entered by hand as
  algebraic formulas.</p>

  <p>Here is a complete list of the standard models recognized by
  <kbd>a F</kbd>:</p>

  <dl compact="compact">
    <dt><kbd>1</kbd></dt>

    <dd>
      <p>Linear or multilinear. <i>a + b x + c y + d z</i>.</p>
    </dd>

    <dt><kbd>2-9</kbd></dt>

    <dd>
      <p>Polynomials. <i>a + b x + c x^2 + d x^3</i>.</p>
    </dd>

    <dt><kbd>e</kbd></dt>

    <dd>
      <p>Exponential. <i>a</i> <tt>exp</tt><i>(b x)</i>
      <tt>exp</tt><i>(c y)</i>.</p>
    </dd>

    <dt><kbd>E</kbd></dt>

    <dd>
      <p>Base-10 exponential. <i>a</i> <tt>10^</tt><i>(b x)</i>
      <tt>10^</tt><i>(c y)</i>.</p>
    </dd>

    <dt><kbd>x</kbd></dt>

    <dd>
      <p>Exponential (alternate notation). <tt>exp</tt><i>(a + b x
      + c y)</i>.</p>
    </dd>

    <dt><kbd>X</kbd></dt>

    <dd>
      <p>Base-10 exponential (alternate). <tt>10^</tt><i>(a + b x +
      c y)</i>.</p>
    </dd>

    <dt><kbd>l</kbd></dt>

    <dd>
      <p>Logarithmic. <i>a + b</i> <tt>ln</tt><i>(x) + c</i>
      <tt>ln</tt><i>(y)</i>.</p>
    </dd>

    <dt><kbd>L</kbd></dt>

    <dd>
      <p>Base-10 logarithmic. <i>a + b</i> <tt>log10</tt><i>(x) +
      c</i> <tt>log10</tt><i>(y)</i>.</p>
    </dd>

    <dt><kbd>^</kbd></dt>

    <dd>
      <p>General exponential. <i>a b^x c^y</i>.</p>
    </dd>

    <dt><kbd>p</kbd></dt>

    <dd>
      <p>Power law. <i>a x^b y^c</i>.</p>
    </dd>

    <dt><kbd>q</kbd></dt>

    <dd>
      <p>Quadratic. <i>a + b (x-c)^2 + d (x-e)^2</i>.</p>
    </dd>

    <dt><kbd>g</kbd></dt>

    <dd>
      <p>Gaussian. <i>(a / b sqrt(2 pi))
      exp(-0.5*((x-c)/b)^2)</i>.</p>
    </dd>

    <dt><kbd>s</kbd></dt>

    <dd>
      <p>Logistic <em>s</em> curve. <i>a/(1 + exp(b (x -
      c)))</i>.</p>
    </dd>

    <dt><kbd>b</kbd></dt>

    <dd>
      <p>Logistic bell curve. <i>a exp(b (x - c))/(1 + exp(b (x -
      c)))^2</i>.</p>
    </dd>

    <dt><kbd>o</kbd></dt>

    <dd>
      <p>Hubbert linearization. <i>(y/x) = a (1 - x/b)</i>.</p>
    </dd>
  </dl>

  <p>All of these models are used in the usual way; just press the
  appropriate letter at the model prompt, and choose variable names
  if you wish. The result will be a formula as shown in the above
  table, with the best-fit values of the parameters substituted.
  (You may find it easier to read the parameter values from the
  vector that is placed in the trail.)</p>

  <p>All models except Gaussian, logistics, Hubbert and polynomials
  can generalize as shown to any number of independent variables.
  Also, all the built-in models except for the logistic and Hubbert
  curves have an additive or multiplicative parameter shown as
  &lsquo;<samp>a</samp>&rsquo; in the above table which can be
  replaced by zero or one, as appropriate, by typing <kbd>h</kbd>
  before the model key.</p>

  <p>Note that many of these models are essentially equivalent, but
  express the parameters slightly differently. For example,
  &lsquo;<samp>a b^x</samp>&rsquo; and the other two exponential
  models are all algebraic rearrangements of each other. Also, the
  &ldquo;quadratic&rdquo; model is just a degree-2 polynomial with
  the parameters expressed differently. Use whichever form best
  matches the problem.</p>

  <p>The HP-28/48 calculators support four different models for
  curve fitting, called <code>LIN</code>, <code>LOG</code>,
  <code>EXP</code>, and <code>PWR</code>. These correspond to Calc
  models &lsquo;<samp>a + b x</samp>&rsquo;, &lsquo;<samp>a + b
  ln(x)</samp>&rsquo;, &lsquo;<samp>a exp(b x)</samp>&rsquo;, and
  &lsquo;<samp>a x^b</samp>&rsquo;, respectively. In each case,
  &lsquo;<samp>a</samp>&rsquo; is what the HP-48 identifies as the
  &ldquo;intercept,&rdquo; and &lsquo;<samp>b</samp>&rsquo; is what
  it calls the &ldquo;slope.&rdquo;</p>

  <p>If the model you want doesn&rsquo;t appear on this list, press
  <kbd>'</kbd> (the apostrophe key) at the model prompt to enter
  any algebraic formula, such as <kbd>m x - b</kbd>, as the model.
  (Not all models will work, though&mdash;see the next section for
  details.)</p>

  <p>The model can also be an equation like &lsquo;<samp>y = m x +
  b</samp>&rsquo;. In this case, Calc thinks of all the rows of the
  data matrix on equal terms; this model effectively has two
  parameters (&lsquo;<samp>m</samp>&rsquo; and
  &lsquo;<samp>b</samp>&rsquo;) and two independent variables
  (&lsquo;<samp>x</samp>&rsquo; and &lsquo;<samp>y</samp>&rsquo;),
  with no &ldquo;dependent&rdquo; variables. Model equations do not
  need to take this &lsquo;<samp>y =</samp>&rsquo; form. For
  example, the implicit line equation &lsquo;<samp>a x + b y =
  1</samp>&rsquo; works fine as a model.</p>

  <p>When you enter a model, Calc makes an alphabetical list of all
  the variables that appear in the model. These are used for the
  default parameters, independent variables, and dependent variable
  (in that order). If you enter a plain formula (not an equation),
  Calc assumes the dependent variable does not appear in the
  formula and thus does not need a name.</p>

  <p>For example, if the model formula has the variables
  &lsquo;<samp>a,mu,sigma,t,x</samp>&rsquo;, and the data matrix
  has three rows (meaning two independent variables), Calc will use
  &lsquo;<samp>a,mu,sigma</samp>&rsquo; as the default parameters,
  and the data rows will be named &lsquo;<samp>t</samp>&rsquo; and
  &lsquo;<samp>x</samp>&rsquo;, respectively. If you enter an
  equation instead of a plain formula, Calc will use
  &lsquo;<samp>a,mu</samp>&rsquo; as the parameters, and
  &lsquo;<samp>sigma,t,x</samp>&rsquo; as the three independent
  variables.</p>

  <p>You can, of course, override these choices by entering
  something different at the prompt. If you leave some variables
  out of the list, those variables must have stored values and
  those stored values will be used as constants in the model.
  (Stored values for the parameters and independent variables are
  ignored by the <kbd>a F</kbd> command.) If you list only
  independent variables, all the remaining variables in the model
  formula will become parameters.</p>

  <p>If there are <kbd>$</kbd> signs in the model you type, they
  will stand for parameters and all other variables (in
  alphabetical order) will be independent. Use <kbd>$</kbd> for one
  parameter, <kbd>$$</kbd> for another, and so on. Thus <kbd>$ x +
  $$</kbd> is another way to describe a linear model.</p>

  <p>If you type a <kbd>$</kbd> instead of <kbd>'</kbd> at the
  model prompt itself, Calc will take the model formula from the
  stack. (The data must then appear at the second stack level.) The
  same conventions are used to choose which variables in the
  formula are independent by default and which are parameters.</p>

  <p>Models taken from the stack can also be expressed as vectors
  of two or three elements, &lsquo;<samp>[<var>model</var>,
  <var>vars</var>]</samp>&rsquo; or &lsquo;<samp>[<var>model</var>,
  <var>vars</var>, <var>params</var>]</samp>&rsquo;. Each of
  <var>vars</var> and <var>params</var> may be either a variable or
  a vector of variables. (If <var>params</var> is omitted, all
  variables in <var>model</var> except those listed as
  <var>vars</var> are parameters.)</p>

  <p>When you enter a model manually with <kbd>'</kbd>, Calc puts a
  3-vector describing the model in the trail so you can get it back
  if you wish.</p><a name="index-Model1" id="index-Model1"></a>
  <a name="index-Model2" id="index-Model2"></a>

  <p>Finally, you can store a model in one of the Calc variables
  <code>Model1</code> or <code>Model2</code>, then use this model
  by typing <kbd>a F u</kbd> or <kbd>a F U</kbd> (respectively).
  The value stored in the variable can be any of the formats that
  <kbd>a F $</kbd> would accept for a model on the stack.</p>

  <p>Calc uses the principal values of inverse functions like
  <code>ln</code> and <code>arcsin</code> when doing fits. For
  example, when you enter the model &lsquo;<samp>y = sin(a t +
  b)</samp>&rsquo; Calc actually uses the easier form
  &lsquo;<samp>arcsin(y) = a t + b</samp>&rsquo;. The
  <code>arcsin</code> function always returns results in the range
  from <i>-90</i> to 90 degrees (or the equivalent range in
  radians). Suppose you had data that you believed to represent
  roughly three oscillations of a sine wave, so that the argument
  of the sine might go from zero to <i>3*360</i> degrees. The above
  model would appear to be a good way to determine the true
  frequency and phase of the sine wave, but in practice it would
  fail utterly. The righthand side of the actual model
  &lsquo;<samp>arcsin(y) = a t + b</samp>&rsquo; will grow smoothly
  with &lsquo;<samp>t</samp>&rsquo;, but the lefthand side will
  bounce back and forth between <i>-90</i> and 90. No values of
  &lsquo;<samp>a</samp>&rsquo; and &lsquo;<samp>b</samp>&rsquo; can
  make the two sides match, even approximately.</p>

  <p>There is no good solution to this problem at present. You
  could restrict your data to small enough ranges so that the above
  problem doesn&rsquo;t occur (i.e., not straddling any peaks in
  the sine wave). Or, in this case, you could use a totally
  different method such as Fourier analysis, which is beyond the
  scope of the <kbd>a F</kbd> command. (Unfortunately, Calc does
  not currently have any facilities for taking Fourier and related
  transforms.)</p>
  <hr />

  <div class="header">
    <p>Next: <a href=
    "Curve-Fitting-Details.html#Curve-Fitting-Details" accesskey=
    "n" rel="next">Curve Fitting Details</a>, Previous: <a href=
    "Error-Estimates-for-Fits.html#Error-Estimates-for-Fits"
    accesskey="p" rel="prev">Error Estimates for Fits</a>, Up:
    <a href="Curve-Fitting.html#Curve-Fitting" accesskey="u" rel=
    "up">Curve Fitting</a> &nbsp; [<a href=
    "index.html#SEC_Contents" title="Table of contents" rel=
    "contents">Contents</a>][<a href="Key-Index.html#Key-Index"
    title="Index" rel="index">Index</a>]</p>
  </div>
</body>
</html>
