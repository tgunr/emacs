<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<!-- Copyright (C) 1995-1997, 2001-2016 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, with the Front-Cover Texts being "A GNU Manual",
and with the Back-Cover Texts as in (a) below.  A copy of the license
is included in the section entitled "GNU Free Documentation License".

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual." -->
<!-- Created by GNU Texinfo 5.2, http://www.gnu.org/software/texinfo/ -->

<head>
  <meta name="generator" content=
  "HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 16.1), see www.w3.org" />

  <title>Viper Is a Package for Emacs Rebels: Packages that Change
  Keymaps</title>
  <meta name="description" content=
  "Viper Is a Package for Emacs Rebels: Packages that Change Keymaps" />
  <meta name="keywords" content=
  "Viper Is a Package for Emacs Rebels: Packages that Change Keymaps" />
  <meta name="resource-type" content="document" />
  <meta name="distribution" content="global" />
  <meta name="Generator" content="makeinfo" />
  <meta http-equiv="Content-Type" content=
  "text/html; charset=us-ascii" />
  <link href="index.html#Top" rel="start" title="Top" />
  <link href="Key-Index.html#Key-Index" rel="index" title=
  "Key Index" />
  <link href="index.html#SEC_Contents" rel="contents" title=
  "Table of Contents" />
  <link href="Customization.html#Customization" rel="up" title=
  "Customization" />
  <link href="Viper-Specials.html#Viper-Specials" rel="next" title=
  "Viper Specials" />
  <link href="Key-Bindings.html#Key-Bindings" rel="prev" title=
  "Key Bindings" />
  <style type="text/css">
/*<![CDATA[*/
  <!--
  a.summary-letter {text-decoration: none}
  blockquote.smallquotation {font-size: smaller}
  div.display {margin-left: 3.2em}
  div.example {margin-left: 3.2em}
  div.indentedblock {margin-left: 3.2em}
  div.lisp {margin-left: 3.2em}
  div.smalldisplay {margin-left: 3.2em}
  div.smallexample {margin-left: 3.2em}
  div.smallindentedblock {margin-left: 3.2em; font-size: smaller}
  div.smalllisp {margin-left: 3.2em}
  kbd {font-style:oblique}
  pre.display {font-family: inherit}
  pre.format {font-family: inherit}
  pre.menu-comment {font-family: serif}
  pre.menu-preformatted {font-family: serif}
  pre.smalldisplay {font-family: inherit; font-size: smaller}
  pre.smallexample {font-size: smaller}
  pre.smallformat {font-family: inherit; font-size: smaller}
  pre.smalllisp {font-size: smaller}
  span.nocodebreak {white-space:nowrap}
  span.nolinebreak {white-space:nowrap}
  span.roman {font-family:serif; font-weight:normal}
  span.sansserif {font-family:sans-serif; font-weight:normal}
  ul.no-bullet {list-style: none}
  -->
  /*]]>*/
  </style>
  <style type="text/css">
/*<![CDATA[*/
  body {
  background-color: #FFFFFF;
  color: #000000;
  }
  :link { color: #0000FF }
  :visited { color: #800080 }
  :active { color: #FF0000 }
  /*]]>*/
  </style>
</head>

<body lang="en" xml:lang="en">
  <a name="Packages-that-Change-Keymaps" id=
  "Packages-that-Change-Keymaps"></a>

  <div class="header">
    <p>Next: <a href="Viper-Specials.html#Viper-Specials"
    accesskey="n" rel="next">Viper Specials</a>, Previous: <a href=
    "Key-Bindings.html#Key-Bindings" accesskey="p" rel="prev">Key
    Bindings</a>, Up: <a href="Customization.html#Customization"
    accesskey="u" rel="up">Customization</a> &nbsp; [<a href=
    "index.html#SEC_Contents" title="Table of contents" rel=
    "contents">Contents</a>][<a href="Key-Index.html#Key-Index"
    title="Index" rel="index">Index</a>]</p>
  </div>
  <hr />
  <a name="Packages-that-Change-Keymaps-1" id=
  "Packages-that-Change-Keymaps-1"></a>

  <h3 class="section">3.3 Packages that Change Keymaps</h3><a name=
  "index-C_002dc-and-Viper" id="index-C_002dc-and-Viper"></a>
  <a name="index-Viper-and-C_002dc" id=
  "index-Viper-and-C_002dc"></a>

  <p>Viper is designed to coexist with all major and minor modes of
  Emacs. This means that bindings set by those modes are generally
  available with Viper (unless you explicitly prohibit them by
  setting <code>viper-want-emacs-keys-in-vi</code> and
  <code>viper-want-emacs-keys-in-insert</code> to
  <code>nil</code>). If <code>viper-always</code> is set to
  <code>t</code> (which is the default), Viper will try to bring
  each buffer in the Viper state that is most appropriate for that
  buffer. Usually, this would be the Vi state, but sometimes it
  could be the Insert state or the Emacs state.</p>

  <p>Some major mode bindings will necessarily be overwritten by
  Viper. Indeed, in Vi state, most of the 1-character keys are used
  for Vi-style editing. This usually causes no problems because
  most packages designed for editing files typically do not bind
  such keys. Instead, they use key sequences that start with
  <kbd>C-x</kbd> and <kbd>C-c</kbd>. This is why it was so
  important for us to free up <kbd>C-x</kbd> and <kbd>C-c</kbd>. It
  is common for language-specific major modes to bind <tt class=
  "key">TAB</tt> and <kbd>C-j</kbd> (the line feed) keys to various
  formatting functions. This is extremely useful, but may require
  some getting used to for a Vi user. If you decide that this
  feature is not for you, you can re-bind these keys as explained
  earlier (see <a href=
  "Customization.html#Customization">Customization</a>).</p>

  <p>Binding for <tt class="key">TAB</tt> is one of the most
  unusual aspects of Viper for many novice users. In Emacs,
  <tt class="key">TAB</tt> is used to format text and programs, and
  is extremely useful. For instance, hitting <tt class=
  "key">TAB</tt> causes the current line to be re-indented in
  accordance with the context. In programming, this is very
  important, since improper automatic indentation would immediately
  alert the programmer to a possible error. For instance, if a
  <kbd>)</kbd> or a <kbd>"</kbd> is missing somewhere above the
  current line, <tt class="key">TAB</tt> is likely to mis-indent
  the line.</p>

  <p>For this reason, Viper doesn&rsquo;t change the standard Emacs
  binding of <tt class="key">TAB</tt>, thereby sacrificing Vi
  compatibility (except for users at level 1). Instead, in Viper,
  the key <kbd>S-tab</kbd> (shift+ tab) is chosen to emulate
  Vi&rsquo;s <tt class="key">TAB</tt>.</p>

  <p>We should note that on some non-windowing terminals, Shift
  doesn&rsquo;t modify the <tt class="key">TAB</tt> key, so
  <kbd>S-tab</kbd> behaves as if it were <tt class="key">TAB</tt>.
  In such a case, you will have to bind
  <code>viper-insert-tab</code> to some other convenient key.</p>

  <p>Some packages, notably Dired, Gnus, Info, etc., attach special
  meaning to common keys like <tt class="key">SPC</tt>,
  <kbd>x</kbd>, <kbd>d</kbd>, <kbd>v</kbd>, and others. This means
  that Vi command state is inappropriate for working with these
  packages. Fortunately, these modes operate on read-only buffers
  and are designed not for editing files, but for special-purpose
  browsing, reading news, mail, etc., and Vi commands are
  meaningless in these situations. For this reason, Viper
  doesn&rsquo;t force Vi state on such major modes&mdash;it brings
  them in Emacs state. You can switch to Vi state by typing
  <kbd>C-z</kbd> if, for instance, you want to do Vi-style search
  in a buffer (although, usually, incremental search, which is
  bound to <kbd>C-s</kbd>, is sufficient in these situations). But
  you should then switch back to Emacs state if you plan to
  continue using these major modes productively. You can also
  switch to Vi temporarily, to execute just one command. This is
  done by typing <kbd>C-c \</kbd>. (In some of these modes,
  <kbd>/</kbd> and <kbd>:</kbd> are bound Vi-style, unless these
  keys perform essential duties.)</p>

  <p>If you would like certain major modes to come up in Emacs
  state rather than Vi state (but Viper thinks otherwise), you
  should put these major modes on the
  <code>viper-emacs-state-mode-list</code> list and delete them
  from <code>viper-vi-state-mode-list</code>. Likewise, you can
  force Viper&rsquo;s Insert state on a major mode by putting it in
  <code>viper-insert-state-mode-list</code>. <a name=
  "index-viper_002demacs_002dstate_002dmode_002dlist" id=
  "index-viper_002demacs_002dstate_002dmode_002dlist"></a> <a name=
  "index-viper_002dinsert_002dstate_002dmode_002dlist" id=
  "index-viper_002dinsert_002dstate_002dmode_002dlist"></a>
  <a name="index-viper_002dvi_002dstate_002dmode_002dlist" id=
  "index-viper_002dvi_002dstate_002dmode_002dlist"></a></p>

  <p>It is also possible to impose Vi on some major modes, even
  though they may bind common keys to specialized commands. This
  might make sense for modes that bind only a small number of
  common keys. For instance, Viper subverts the Shell mode by
  changing the bindings for <kbd>C-m</kbd> and <kbd>C-d</kbd> using
  <code>viper-add-local-keys</code> described in the section on
  customization (see <a href=
  "Customization.html#Customization">Customization</a>).</p>

  <p>In some cases, some <em>minor</em> modes might override
  certain essential bindings in Vi command state. This is not a big
  problem because this can happen only in the beginning, when the
  minor mode kicks in. Typing <code>M-x viper-mode</code> will
  correct the situation. Viper knows about several such minor modes
  and takes care of them, so the above trick is usually not
  necessary. If you find that some minor mode, e.g.,
  <code>nasty-mode</code> interferes with Viper, putting the
  following in your Viper customization file should fix the
  problem:</p>

  <div class="lisp">
    <pre class="lisp">
(viper-harness-minor-mode "nasty-mode")
</pre>
  </div>

  <p>The argument to <code>viper-harness-minor-mode</code> is the
  name of the file for the offending minor mode with the suffixes
  <samp>.el</samp> and <samp>.elc</samp> removed.</p>

  <p>It may not be always obvious which minor mode is at fault. The
  only guidance here is to look into the file that defines the
  minor mode you are suspecting, say <samp>nasty-mode.el</samp>,
  and see if it has a variable called <code>nasty-mode-map</code>.
  Then check if there is a statement of the form</p>

  <div class="lisp">
    <pre class="lisp">
(define-key nasty-mode-map key function)
</pre>
  </div>

  <p>that binds the misbehaving keys. If so, use the above line to
  harness <code>nasty-mode</code>. If your suspicion is wrong, no
  harm is done if you harness a minor mode that doesn&rsquo;t need
  to be harnessed.</p>

  <p>It is recommended to harness even those minor modes that
  don&rsquo;t override Viper keys, but still have their own
  keymaps. A general way to make a minor mode,
  <code>my-mode</code>, compatible with Viper is to have the file
  <samp>my-mode.el</samp> include the following code:</p>

  <div class="lisp">
    <pre class="lisp">
(when (fboundp 'viper-harness-minor-mode)
  (let ((lib (file-name-sans-extension
               (file-name-nondirectory load-file-name))))
    (viper-harness-minor-mode lib)))
</pre>
  </div><a name=
  "index-viper_002dwant_002demacs_002dkeys_002din_002dvi-1" id=
  "index-viper_002dwant_002demacs_002dkeys_002din_002dvi-1"></a>
  <a name=
  "index-viper_002dwant_002demacs_002dkeys_002din_002dinsert-1" id=
  "index-viper_002dwant_002demacs_002dkeys_002din_002dinsert-1"></a>
  <a name="index-viper_002dalways-1" id=
  "index-viper_002dalways-1"></a> <a name=
  "index-viper_002dset_002dhooks" id=
  "index-viper_002dset_002dhooks"></a> <a name=
  "index-viper_002dmode" id="index-viper_002dmode"></a> <a name=
  "index-viper_002dharness_002dminor_002dmode" id=
  "index-viper_002dharness_002dminor_002dmode"></a> <a name=
  "index-remove_002dhook" id="index-remove_002dhook"></a> <a name=
  "index-add_002dhook" id="index-add_002dhook"></a>
  <hr />

  <div class="header">
    <p>Next: <a href="Viper-Specials.html#Viper-Specials"
    accesskey="n" rel="next">Viper Specials</a>, Previous: <a href=
    "Key-Bindings.html#Key-Bindings" accesskey="p" rel="prev">Key
    Bindings</a>, Up: <a href="Customization.html#Customization"
    accesskey="u" rel="up">Customization</a> &nbsp; [<a href=
    "index.html#SEC_Contents" title="Table of contents" rel=
    "contents">Contents</a>][<a href="Key-Index.html#Key-Index"
    title="Index" rel="index">Index</a>]</p>
  </div>
</body>
</html>
